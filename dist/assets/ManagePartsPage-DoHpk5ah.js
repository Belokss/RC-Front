import{g as G,b as Y,r as c,s as D,am as re,an as ie,O as U,_ as i,U as se,d as q,u as le,e as z,j as a,f as k,h as H,ao as ce,T as Q,ap as de,i as J,L as Z,K as pe,J as ue,a2 as te,ag as ge,S as ae,q as me,v as fe}from"./index-B7pbG10J.js";import{a as ee}from"./axios-BWYlR7gC.js";import{i as xe}from"./FormControl-xkAvr5_W.js";import{L as ve}from"./ListItemSecondaryAction-C4VmUl8b.js";import{u as be,T as he}from"./TextField-BAwGPyVk.js";import{B as _}from"./OutlinedInput-B-nMwLxM.js";import"./useControlled-_MYzYhVX.js";function Ce(e){return Y("MuiDialog",e)}const oe=G("MuiDialog",["root","scrollPaper","scrollBody","container","paper","paperScrollPaper","paperScrollBody","paperWidthFalse","paperWidthXs","paperWidthSm","paperWidthMd","paperWidthLg","paperWidthXl","paperFullWidth","paperFullScreen"]),ne=c.createContext({}),ye=["aria-describedby","aria-labelledby","BackdropComponent","BackdropProps","children","className","disableEscapeKeyDown","fullScreen","fullWidth","maxWidth","onBackdropClick","onClick","onClose","open","PaperComponent","PaperProps","scroll","TransitionComponent","transitionDuration","TransitionProps"],ke=D(re,{name:"MuiDialog",slot:"Backdrop",overrides:(e,o)=>o.backdrop})({zIndex:-1}),De=e=>{const{classes:o,scroll:t,maxWidth:s,fullWidth:d,fullScreen:r}=e,u={root:["root"],container:["container",`scroll${U(t)}`],paper:["paper",`paperScroll${U(t)}`,`paperWidth${U(String(s))}`,d&&"paperFullWidth",r&&"paperFullScreen"]};return H(u,Ce,o)},Re=D(ie,{name:"MuiDialog",slot:"Root",overridesResolver:(e,o)=>o.root})({"@media print":{position:"absolute !important"}}),$e=D("div",{name:"MuiDialog",slot:"Container",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[o.container,o[`scroll${U(t.scroll)}`]]}})(({ownerState:e})=>i({height:"100%","@media print":{height:"auto"},outline:0},e.scroll==="paper"&&{display:"flex",justifyContent:"center",alignItems:"center"},e.scroll==="body"&&{overflowY:"auto",overflowX:"hidden",textAlign:"center","&::after":{content:'""',display:"inline-block",verticalAlign:"middle",height:"100%",width:"0"}})),Pe=D(se,{name:"MuiDialog",slot:"Paper",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[o.paper,o[`scrollPaper${U(t.scroll)}`],o[`paperWidth${U(String(t.maxWidth))}`],t.fullWidth&&o.paperFullWidth,t.fullScreen&&o.paperFullScreen]}})(({theme:e,ownerState:o})=>i({margin:32,position:"relative",overflowY:"auto","@media print":{overflowY:"visible",boxShadow:"none"}},o.scroll==="paper"&&{display:"flex",flexDirection:"column",maxHeight:"calc(100% - 64px)"},o.scroll==="body"&&{display:"inline-block",verticalAlign:"middle",textAlign:"left"},!o.maxWidth&&{maxWidth:"calc(100% - 64px)"},o.maxWidth==="xs"&&{maxWidth:e.breakpoints.unit==="px"?Math.max(e.breakpoints.values.xs,444):`max(${e.breakpoints.values.xs}${e.breakpoints.unit}, 444px)`,[`&.${oe.paperScrollBody}`]:{[e.breakpoints.down(Math.max(e.breakpoints.values.xs,444)+32*2)]:{maxWidth:"calc(100% - 64px)"}}},o.maxWidth&&o.maxWidth!=="xs"&&{maxWidth:`${e.breakpoints.values[o.maxWidth]}${e.breakpoints.unit}`,[`&.${oe.paperScrollBody}`]:{[e.breakpoints.down(e.breakpoints.values[o.maxWidth]+32*2)]:{maxWidth:"calc(100% - 64px)"}}},o.fullWidth&&{width:"calc(100% - 64px)"},o.fullScreen&&{margin:0,width:"100%",maxWidth:"100%",height:"100%",maxHeight:"none",borderRadius:0,[`&.${oe.paperScrollBody}`]:{margin:0,maxWidth:"100%"}})),Se=c.forwardRef(function(o,t){const s=q({props:o,name:"MuiDialog"}),d=le(),r={enter:d.transitions.duration.enteringScreen,exit:d.transitions.duration.leavingScreen},{"aria-describedby":u,"aria-labelledby":g,BackdropComponent:f,BackdropProps:x,children:p,className:w,disableEscapeKeyDown:R=!1,fullScreen:S=!1,fullWidth:j=!1,maxWidth:L="sm",onBackdropClick:$,onClick:T,onClose:P,open:B,PaperComponent:N=se,PaperProps:n={},scroll:l="paper",TransitionComponent:m=ce,transitionDuration:b=r,TransitionProps:M}=s,C=z(s,ye),v=i({},s,{disableEscapeKeyDown:R,fullScreen:S,fullWidth:j,maxWidth:L,scroll:l}),I=De(v),y=c.useRef(),K=h=>{y.current=h.target===h.currentTarget},F=h=>{T&&T(h),y.current&&(y.current=null,$&&$(h),P&&P(h,"backdropClick"))},E=be(g),X=c.useMemo(()=>({titleId:E}),[E]);return a.jsx(Re,i({className:k(I.root,w),closeAfterTransition:!0,components:{Backdrop:ke},componentsProps:{backdrop:i({transitionDuration:b,as:f},x)},disableEscapeKeyDown:R,onClose:P,open:B,ref:t,onClick:F,ownerState:v},C,{children:a.jsx(m,i({appear:!0,in:B,timeout:b,role:"presentation"},M,{children:a.jsx($e,{className:k(I.container),onMouseDown:K,ownerState:v,children:a.jsx(Pe,i({as:N,elevation:24,role:"dialog","aria-describedby":u,"aria-labelledby":E},n,{className:k(I.paper,n.className),ownerState:v,children:a.jsx(ne.Provider,{value:X,children:p})}))})}))}))});function je(e){return Y("MuiDialogActions",e)}G("MuiDialogActions",["root","spacing"]);const Me=["className","disableSpacing"],Ie=e=>{const{classes:o,disableSpacing:t}=e;return H({root:["root",!t&&"spacing"]},je,o)},We=D("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[o.root,!t.disableSpacing&&o.spacing]}})(({ownerState:e})=>i({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!e.disableSpacing&&{"& > :not(style) ~ :not(style)":{marginLeft:8}})),Ae=c.forwardRef(function(o,t){const s=q({props:o,name:"MuiDialogActions"}),{className:d,disableSpacing:r=!1}=s,u=z(s,Me),g=i({},s,{disableSpacing:r}),f=Ie(g);return a.jsx(We,i({className:k(f.root,d),ownerState:g,ref:t},u))});function we(e){return Y("MuiDialogContent",e)}G("MuiDialogContent",["root","dividers"]);function Le(e){return Y("MuiDialogTitle",e)}const Te=G("MuiDialogTitle",["root"]),Be=["className","dividers"],Ne=e=>{const{classes:o,dividers:t}=e;return H({root:["root",t&&"dividers"]},we,o)},Fe=D("div",{name:"MuiDialogContent",slot:"Root",overridesResolver:(e,o)=>{const{ownerState:t}=e;return[o.root,t.dividers&&o.dividers]}})(({theme:e,ownerState:o})=>i({flex:"1 1 auto",WebkitOverflowScrolling:"touch",overflowY:"auto",padding:"20px 24px"},o.dividers?{padding:"16px 24px",borderTop:`1px solid ${(e.vars||e).palette.divider}`,borderBottom:`1px solid ${(e.vars||e).palette.divider}`}:{[`.${Te.root} + &`]:{paddingTop:0}})),Ee=c.forwardRef(function(o,t){const s=q({props:o,name:"MuiDialogContent"}),{className:d,dividers:r=!1}=s,u=z(s,Be),g=i({},s,{dividers:r}),f=Ne(g);return a.jsx(Fe,i({className:k(f.root,d),ownerState:g,ref:t},u))}),Oe=["className","id"],Ue=e=>{const{classes:o}=e;return H({root:["root"]},Le,o)},ze=D(Q,{name:"MuiDialogTitle",slot:"Root",overridesResolver:(e,o)=>o.root})({padding:"16px 24px",flex:"0 0 auto"}),Ve=c.forwardRef(function(o,t){const s=q({props:o,name:"MuiDialogTitle"}),{className:d,id:r}=s,u=z(s,Oe),g=s,f=Ue(g),{titleId:x=r}=c.useContext(ne);return a.jsx(ze,i({component:"h2",className:k(f.root,d),ownerState:g,ref:t,variant:"h6",id:r??x},u))});function _e(e){return Y("MuiListItem",e)}const O=G("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]),Ge=["className"],Ye=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected","slotProps","slots"],qe=(e,o)=>{const{ownerState:t}=e;return[o.root,t.dense&&o.dense,t.alignItems==="flex-start"&&o.alignItemsFlexStart,t.divider&&o.divider,!t.disableGutters&&o.gutters,!t.disablePadding&&o.padding,t.button&&o.button,t.hasSecondaryAction&&o.secondaryAction]},He=e=>{const{alignItems:o,button:t,classes:s,dense:d,disabled:r,disableGutters:u,disablePadding:g,divider:f,hasSecondaryAction:x,selected:p}=e;return H({root:["root",d&&"dense",!u&&"gutters",!g&&"padding",f&&"divider",r&&"disabled",t&&"button",o==="flex-start"&&"alignItemsFlexStart",x&&"secondaryAction",p&&"selected"],container:["container"]},_e,s)},Ke=D("div",{name:"MuiListItem",slot:"Root",overridesResolver:qe})(({theme:e,ownerState:o})=>i({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!o.disablePadding&&i({paddingTop:8,paddingBottom:8},o.dense&&{paddingTop:4,paddingBottom:4},!o.disableGutters&&{paddingLeft:16,paddingRight:16},!!o.secondaryAction&&{paddingRight:48}),!!o.secondaryAction&&{[`& > .${de.root}`]:{paddingRight:48}},{[`&.${O.focusVisible}`]:{backgroundColor:(e.vars||e).palette.action.focus},[`&.${O.selected}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:J(e.palette.primary.main,e.palette.action.selectedOpacity),[`&.${O.focusVisible}`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.focusOpacity}))`:J(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.focusOpacity)}},[`&.${O.disabled}`]:{opacity:(e.vars||e).palette.action.disabledOpacity}},o.alignItems==="flex-start"&&{alignItems:"flex-start"},o.divider&&{borderBottom:`1px solid ${(e.vars||e).palette.divider}`,backgroundClip:"padding-box"},o.button&&{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(e.vars||e).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${O.selected}:hover`]:{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / calc(${e.vars.palette.action.selectedOpacity} + ${e.vars.palette.action.hoverOpacity}))`:J(e.palette.primary.main,e.palette.action.selectedOpacity+e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:e.vars?`rgba(${e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.selectedOpacity})`:J(e.palette.primary.main,e.palette.action.selectedOpacity)}}},o.hasSecondaryAction&&{paddingRight:48})),Xe=D("li",{name:"MuiListItem",slot:"Container",overridesResolver:(e,o)=>o.container})({position:"relative"}),Je=c.forwardRef(function(o,t){const s=q({props:o,name:"MuiListItem"}),{alignItems:d="center",autoFocus:r=!1,button:u=!1,children:g,className:f,component:x,components:p={},componentsProps:w={},ContainerComponent:R="li",ContainerProps:{className:S}={},dense:j=!1,disabled:L=!1,disableGutters:$=!1,disablePadding:T=!1,divider:P=!1,focusVisibleClassName:B,secondaryAction:N,selected:n=!1,slotProps:l={},slots:m={}}=s,b=z(s.ContainerProps,Ge),M=z(s,Ye),C=c.useContext(Z),v=c.useMemo(()=>({dense:j||C.dense||!1,alignItems:d,disableGutters:$}),[d,C.dense,j,$]),I=c.useRef(null);pe(()=>{r&&I.current&&I.current.focus()},[r]);const y=c.Children.toArray(g),K=y.length&&xe(y[y.length-1],["ListItemSecondaryAction"]),F=i({},s,{alignItems:d,autoFocus:r,button:u,dense:v.dense,disabled:L,disableGutters:$,disablePadding:T,divider:P,hasSecondaryAction:K,selected:n}),E=He(F),X=ue(I,t),h=m.root||p.Root||Ke,V=l.root||w.root||{},W=i({className:k(E.root,V.className,f),disabled:L},M);let A=x||"li";return u&&(W.component=x||"div",W.focusVisibleClassName=k(O.focusVisible,B),A=ge),K?(A=!W.component&&!x?"div":A,R==="li"&&(A==="li"?A="div":W.component==="li"&&(W.component="div")),a.jsx(Z.Provider,{value:v,children:a.jsxs(Xe,i({as:R,className:k(E.container,S),ref:X,ownerState:F},b,{children:[a.jsx(h,i({},V,!te(h)&&{as:A,ownerState:i({},F,V.ownerState)},W,{children:y})),y.pop()]}))})):a.jsx(Z.Provider,{value:v,children:a.jsxs(h,i({},V,{as:A,ref:X},!te(h)&&{ownerState:i({},F,V.ownerState)},W,{children:[y,N&&a.jsx(ve,{children:N})]}))})}),no=()=>{const[e,o]=c.useState(""),[t,s]=c.useState([]),[d,r]=c.useState(!1),[u,g]=c.useState([]),[f,x]=c.useState(!1),[p,w]=c.useState("lv"),R=c.useRef(null),S=c.useRef([]),j=c.useRef(null),L=()=>{w(n=>n==="ru"?"lv":"ru")},$=n=>{o(n.target.value)},T=async()=>{if(f)R.current.stop(),x(!1);else try{const n=await navigator.mediaDevices.getUserMedia({audio:!0});j.current=n;let l="";if(MediaRecorder.isTypeSupported("audio/webm;codecs=opus"))l="audio/webm;codecs=opus";else if(MediaRecorder.isTypeSupported("audio/ogg;codecs=opus"))l="audio/ogg;codecs=opus";else{console.error("No available audio recording formats");return}const m=new MediaRecorder(n,{mimeType:l});R.current=m,S.current=[],m.ondataavailable=b=>{b.data.size>0&&S.current.push(b.data)},m.onstop=async()=>{const b=new Blob(S.current,{type:l}),M=new FormData;M.append("audio",b,"recording.webm"),M.append("language",p);try{const C=await ee.post("/api/voice-command",M,{headers:{"Content-Type":"multipart/form-data"},maxContentLength:1/0,maxBodyLength:1/0}),{changes:v}=C.data;Array.isArray(v)?s(v):(console.error("Expected changes array, received:",v),s([])),r(!0)}catch(C){console.error("Error processing audio:",C)}j.current.getTracks().forEach(C=>C.stop())},m.start(),x(!0)}catch(n){console.error("Error accessing microphone:",n)}},P=n=>{const l=n.action==="add"?"Pievienots":"Izņemts",m=n.quantity||"1";return`${n.manufacturer} ${n.model} ${n.part} ${m}gab. - ${l}`},B=async n=>{try{const l=await ee.post("/api/process-command",{command:n,language:p}),{changes:m}=l.data;Array.isArray(m)?s(m):(console.error("Expected changes array, received:",m),s([])),r(!0)}catch(l){console.error("Error processing command:",l)}},N=async()=>{try{await ee.post("/api/execute-changes",{changes:t});const n=t.map(l=>{const m=new Date().toLocaleString(),b=P(l);return`${m} - ${b}`});g(l=>[...n,...l]),r(!1),o(""),s([])}catch(n){console.error("Error executing changes:",n)}};return a.jsxs(ae,{spacing:3,sx:{p:2,height:"85vh"},children:[a.jsx(Q,{variant:"h4",children:"Rezerves daļu pārvaldība"}),a.jsxs(ae,{sx:{height:"60vh",overflowY:"auto",bgcolor:"grey.100",p:3,borderRadius:2,width:"100%",boxShadow:2},children:[a.jsx(Q,{variant:"h6",children:"Izmaiņu žurnāls"}),a.jsx(me,{children:u.map((n,l)=>a.jsx(Je,{children:a.jsx(fe,{primary:n})},l))})]}),a.jsx(he,{label:p==="ru"?"Введите команду":"Ievadiet komandu",value:e,onChange:$,fullWidth:!0,placeholder:p==="ru"?"Например: Заднее крыло BMW, удалить 3 датчика из Ford":"Piemēram: Aizmugurējais spārns BMW, izņemt 3 sensorus no Ford",sx:{mb:3}}),a.jsx(_,{variant:"outlined",onClick:T,sx:{mb:1},children:f?p==="ru"?"🛑 Остановить запись":"🛑 Pārtraukt ierakstu":p==="ru"?"🎤 Использовать голосовую команду":"🎤 Lietot balss komandu"}),a.jsx(_,{variant:"contained",color:"primary",onClick:()=>B(e),children:p==="ru"?"Обработать команду":"Apstrādāt komandu"}),a.jsx(_,{variant:"outlined",onClick:L,sx:{mt:2},children:p==="ru"?"Переключить на латышский":"Pārslēgt uz krievu valodu"}),a.jsxs(Se,{open:d,onClose:()=>r(!1),children:[a.jsx(Ve,{children:p==="ru"?"Подтвердить изменения":"Apstiprināt izmaiņas"}),a.jsxs(Ee,{children:[a.jsx(Q,{children:p==="ru"?"Вы хотите внести следующие изменения:":"Vai vēlaties veikt šādas izmaiņas:"}),a.jsx("ul",{children:(t||[]).map((n,l)=>a.jsx("li",{children:P(n)},l))})]}),a.jsxs(Ae,{children:[a.jsx(_,{onClick:()=>r(!1),color:"secondary",children:p==="ru"?"Отмена":"Atcelt"}),a.jsx(_,{onClick:N,color:"primary",children:p==="ru"?"Да":"Jā"})]})]})]})};export{no as default};
